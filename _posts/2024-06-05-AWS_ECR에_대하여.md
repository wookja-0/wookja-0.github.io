---
title: "[AWS] ECRì— ëŒ€í•˜ì—¬"
date: 2024-06-05 00:00:00 +0900
categories: ['AWS']
tags: ['AWS', 'container', 'ecr', 'registry']
description: "[AWS] ECRì— ëŒ€í•˜ì—¬"
image: https://cdn-images-1.medium.com/max/800/0*uoebJ1qlgDucVzO5.png
---

### ê°œìš”

**AWS ECR (Elastic Container Registry)** ëŠ” AWSì—ì„œ ì œê³µí•˜ëŠ” ì™„ì „ê´€ë¦¬í˜• ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì €ì¥ì†Œì…ë‹ˆë‹¤. Docker Hubì™€ ìœ ì‚¬í•˜ì§€ë§Œ, IAM ê¸°ë°˜ ê¶Œí•œ ì„¤ì •, ê³ ê°€ìš©ì„±, AWS ì—°ë™ì„± ë“±ì—ì„œ ì¥ì ì„ ì§€ë‹ˆê³  ìˆìŠµë‹ˆë‹¤.

ì´ë²ˆ ê¸€ì—ì„œëŠ” ECRì˜ íŠ¹ì§•ê³¼ ì‚¬ìš© ë°©ë²•ì„ ê°„ë‹¨í•œ Node.js ì˜ˆì œì™€ í•¨ê»˜ ì‹¤ìŠµí•©ë‹ˆë‹¤.

---

## 1. AWS ECRì´ë€?

### ì£¼ìš” ê°œë…

- ì•ˆì „í•˜ê³  í™•ì¥ ê°€ëŠ¥í•œ ì´ë¯¸ì§€ ì €ì¥ì†Œ
- Dockerì™€ í˜¸í™˜
- IAM ê¸°ë°˜ ì ‘ê·¼ ì œì–´ ë° ì´ë¯¸ì§€ ì•”í˜¸í™” ì œê³µ
- ê³ ê°€ìš©ì„± ë³´ì¥ (S3 ê¸°ë°˜ ì €ì¥)
- CI/CD í†µí•© ê°€ëŠ¥ (e.g., CodePipeline, GitHub Actions ë“±)

![](https://cdn-images-1.medium.com/max/800/0*kXcEi4UlMzELlxYo.png)

### ì£¼ìš” ê¸°ëŠ¥ ìš”ì•½

1. ì™„ì „ê´€ë¦¬í˜• ì´ë¯¸ì§€ ì €ì¥ì†Œ (ì„œë²„ ê´€ë¦¬ ë¶ˆí•„ìš”)
2. IAM ê¸°ë°˜ ì¸ì¦ ë° ì„¸ë°€í•œ ê¶Œí•œ ì œì–´
3. ë‚´ì¥ ì•”í˜¸í™” ë° S3 ê¸°ë°˜ ë‚´êµ¬ì„±
4. Docker CLI ì§€ì›
5. CI/CD ì—°ë™ ì‰¬ì›€

---

## 2. ECR ì‹¤ìŠµ: Node.js ì•± Docker ì´ë¯¸ì§€ ì—…ë¡œë“œ

### 2-1. Node.js ì•± ì½”ë“œ ë° Dockerfile ì¤€ë¹„

![](https://cdn-images-1.medium.com/max/800/1*XXROdSV4vXd2q7EK6WWqzQ.png)

**app.js**
```js
const express = require("express");
const app = express();
app.get("/", (req, res) => {
  res.send("Brickmate Node Server");
});
app.listen(4000, () => console.log("Server started"));
```

**Dockerfile**
```dockerfile
FROM node:10.13-alpine
WORKDIR /Desktop/Node
COPY . .
RUN npm install
CMD node app.js
```

### 2-2. ì•± ë¹Œë“œ ë° ì‹¤í–‰

```bash
npm init -y
npm install express
docker build -t sample-app .
docker run -d -p 4000:4000 --name sample-app-container sample-app
```

![](https://cdn-images-1.medium.com/max/800/1*u8uqOMBAw8VS9KJkGCYYxw.png)

### 2-3. AWS ECR ë¦¬í¬ì§€í† ë¦¬ ìƒì„±

IAM ê¶Œí•œ ë³´ìœ  í•„ìš”. ì½˜ì†”ì—ì„œ ë¦¬í¬ì§€í† ë¦¬ ìƒì„± í›„ `push` ê°€ì´ë“œ ì°¸ê³  ê°€ëŠ¥

![](https://cdn-images-1.medium.com/max/800/1*A2vJvUrVY023JtVODhIGLg.png)
![](https://cdn-images-1.medium.com/max/800/1*D9P3UG9_r9ruC-xRF9p84g.png)

### 2-4. AWS ìê²©ì¦ëª… ì„¤ì • & ECR ë¡œê·¸ì¸

```bash
aws configure
# Access Key, Secret Key, region ë“± ì…ë ¥

aws sts get-caller-identity
# ì¸ì¦ í™•ì¸

aws ecr get-login-password --region ap-northeast-2 \
| docker login --username AWS \
--password-stdin <your-account-id>.dkr.ecr.ap-northeast-2.amazonaws.com
```

![](https://cdn-images-1.medium.com/max/800/1*GXZgNE_rPXDKZClrG8blog.png)

### 2-5. Docker ì´ë¯¸ì§€ Push

```bash
docker build --platform linux/amd64 -t sample-app .
docker tag sample-app:latest <repo-url>:latest
docker push <repo-url>:latest
```

ì˜ˆì‹œ:
```bash
docker tag sample-app:latest 853881723062.dkr.ecr.ap-northeast-2.amazonaws.com/sample-app:latest
docker push 853881723062.dkr.ecr.ap-northeast-2.amazonaws.com/sample-app:latest
```

![](https://cdn-images-1.medium.com/max/800/1*9TLFvLU7Se6lEX--iWgbpQ.png)

### 2-6. ECRì—ì„œ ì´ë¯¸ì§€ í™•ì¸

![](https://cdn-images-1.medium.com/max/800/1*wDw1KFh1TdFMTv8Shg-GSg.png)

---

## âœ… ë§ˆë¬´ë¦¬

ì´ë²ˆ ê¸€ì—ì„œëŠ” AWS ECRì˜ ê°œë…ë¶€í„° ê°„ë‹¨í•œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ pushê¹Œì§€ ì‹¤ìŠµí•´ë³´ì•˜ìŠµë‹ˆë‹¤.
ECRì€ ECS, EKSì™€ ì—°ê³„í•  ìˆ˜ ìˆì–´ í–¥í›„ DevOpsë‚˜ í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ ì•± ë°°í¬ì— í•„ìˆ˜ì ì¸ ìš”ì†Œì…ë‹ˆë‹¤.

ë‹¤ìŒ í¬ìŠ¤íŠ¸ì—ì„œëŠ” **ECS(Elastic Container Service)** ì™€ì˜ ì—°ë™ ì‹¤ìŠµìœ¼ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤.

ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ™Œ